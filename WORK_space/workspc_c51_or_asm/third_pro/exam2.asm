	ORG 0000H
	LJMP START
	ORG 0030H
TABLE:
	DB  63, 6, 91, 79, 102 ,109 ,125, 7, 127,111,119,115,64,0
START:
	MOV R0 , #125
MAIN:
	MOV P0 , R0
	ACALL KEYDOWN
	ACALL DELAY
    SJMP MAIN    

KEYDOWN:
    MOV P1 , #0X0F
    ACALL DELAY

    JNB	P1.0, COLUMN_0	
	JNB	P1.1, COLUMN_1	
	JNB	P1.2, COLUMN_2	
	JNB	P1.3, COLUMN_3	
	RET	

COLUMN_0:
	MOV	R0, #0
	JMP	ROW_SCAN
COLUMN_1:
	MOV	R0, #1
	JMP	ROW_SCAN
COLUMN_2:
	MOV	R0, #2
	JMP	ROW_SCAN
COLUMN_3:
	MOV	R0, #3
	JMP	ROW_SCAN

ROW_SCAN:
	MOV	P1, #0xF0
	ACALL DELAY
	JNB	P1.4, ROW_0		
	JNB	P1.5, ROW_1		
	JNB	P1.6, ROW_2		
	JNB	P1.7, ROW_3		
	RET				

ROW_0:
	ADD	A, R0
	MOV	R0, A
	JMP	KEY_RELEASE
ROW_1:
	ADD	A, #4
	ADD	A, R0
	MOV	R0, A
	JMP	KEY_RELEASE
ROW_2:
	ADD	A, #8
	ADD	A, R0
	MOV	R0, A
	JMP	KEY_RELEASE
ROW_3:
	ADD	A, #12
	ADD	A, R0
	MOV	R0, A

KEY_RELEASE:
	ACALL GET_SQUARE
	MOV	R2, #50		
RELEASE_LOOP:
	ACALL	DELAY
	DJNZ	R2, RELEASE_LOOP
	RET

GET_SQUARE:          
    MOV DPTR, #TABLE 
	MOV A , R0
	
    MOVC A, @A+DPTR     
	MOV R0 , A     
	CLR A
    RET

DELAY: MOV R3, #0XFF 
D1: DJNZ R3, D1
    RET

END