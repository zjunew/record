C51 COMPILER V9.59.0.0   PRO                                                               06/13/2024 15:51:14 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE PRO
OBJECT MODULE PLACED IN .\Objects\pro.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\—È ’\3\pro.c LARGE OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(
                    -.\Listings\pro.lst) TABS(2) OBJECT(.\Objects\pro.obj)

line level    source

   1          #include <reg51.h>     
   2          typedef unsigned int u16;   
   3          typedef unsigned char u8;
   4          
   5          sbit LSA=P2^2;
   6          sbit LSB=P2^3;
   7          sbit LSC=P2^4;
   8          
   9          u8 KeyValue = 8 , hour = 12 , min = 0 , second = 0 ,flag = 0;
  10          
  11          u8 code smgduan[19]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,
  12                    0x7f,0x6f,  0x77,0x73,0x40,0x00};//ÊòæÁ§∫0~9,ÁöÑÂÄº
  13          u8 con[9] = {10,12,   1,2,   0,0,    0,0};
  14          
  15          void delay(u16 i)
  16          {
  17   1        while(i--);
  18   1      }
  19          
  20          void KeyDown(void)
  21          {
  22   1        char a=0;
  23   1        P1=0x0f;
  24   1        if(P1!=0x0f)//ËØªÂèñÊåâÈîÆÊòØÂê¶Êåâ‰∏ã
  25   1        {
  26   2          delay(1000);//Âª∂Êó∂10msËøõË°åÊ∂àÊäñ
  27   2          if(P1!=0x0f)//ÂÜçÊ¨°Ê£ÄÊµãÈîÆÁõòÊòØÂê¶Êåâ‰∏ã
  28   2          { 
  29   3            //ÊµãËØïÂàó
  30   3            P1=0X0F;
  31   3            switch(P1)
  32   3            {
  33   4              case(0X07): KeyValue=0;break;
  34   4              case(0X0b): KeyValue=1;break;
  35   4              case(0X0d): KeyValue=2;break;
  36   4              case(0X0e): KeyValue=3;break;
  37   4            }
  38   3            //ÊµãËØïË°å
  39   3            P1=0XF0;
  40   3            switch(P1)
  41   3            {
  42   4              case(0X70): KeyValue=KeyValue;break;
  43   4              case(0Xb0): KeyValue=KeyValue+4;break;
  44   4              case(0Xd0): KeyValue=KeyValue+8;break;
  45   4              case(0Xe0): KeyValue=KeyValue+12;break;
  46   4            }
  47   3            while((a<50)&&(P1!=0xf0))  //Ê£ÄÊµãÊåâÈîÆÊùæÊâãÊ£ÄÊµã
  48   3            {
  49   4              delay(1000);
  50   4              a++;
  51   4            }
  52   3          }
  53   2        }
  54   1      }
C51 COMPILER V9.59.0.0   PRO                                                               06/13/2024 15:51:14 PAGE 2   

  55          
  56          void change()
  57          {
  58   1        con[2] = hour /10 ;
  59   1        con[3] = hour %10 ;
  60   1        con[4] = min /10 ;
  61   1        con[5] = min % 10 ;
  62   1        con[6] = second / 10 ;
  63   1        con[7] = second % 10 ;
  64   1      }
  65          
  66          void DigDisplay()
  67          {
  68   1        u8 i;
  69   1        for(i=0;i<8;i++)
  70   1        {
  71   2          switch(i)  //‰ΩçÈÄâÔºåÈÄâÊã©ÁÇπ‰∫ÆÁöÑÊï∞Á†ÅÁÆ°Ôºå
  72   2          {
  73   3            case(0):
  74   3              LSA=0;LSB=0;LSC=0; break;//ÊòæÁ§∫Á¨¨0‰Ωç
  75   3            case(1):
  76   3              LSA=1;LSB=0;LSC=0; break;//ÊòæÁ§∫Á¨¨1‰Ωç
  77   3            case(2):
  78   3              LSA=0;LSB=1;LSC=0; break;//ÊòæÁ§∫Á¨¨2‰Ωç
  79   3            case(3):
  80   3              LSA=1;LSB=1;LSC=0; break;//ÊòæÁ§∫Á¨¨3‰Ωç
  81   3            case(4):
  82   3              LSA=0;LSB=0;LSC=1; break;//ÊòæÁ§∫Á¨¨4‰Ωç
  83   3            case(5):
  84   3              LSA=1;LSB=0;LSC=1; break;//ÊòæÁ§∫Á¨¨5‰Ωç
  85   3            case(6):
  86   3              LSA=0;LSB=1;LSC=1; break;//ÊòæÁ§∫Á¨¨6‰Ωç
  87   3            case(7):
  88   3              LSA=1;LSB=1;LSC=1; break;//ÊòæÁ§∫Á¨¨7‰Ωç  
  89   3          }
  90   2          P0=smgduan[con[i]];//ÂèëÈÄÅÊÆµÁ†Å
  91   2          delay(100); //Èó¥Èöî‰∏ÄÊÆµÊó∂Èó¥Êâ´Êèè  
  92   2          P0=0x00;//Ê∂àÈöê
  93   2        }
  94   1      }
  95          
  96          void show()
  97          {
  98   1          switch (KeyValue)
  99   1          {
 100   2          case 0:
 101   2              if(hour>=12)
 102   2              {
 103   3                  con[0] = 11;
 104   3                  con[1] = 12;
 105   3                  flag = 1;
 106   3              }
 107   2              else 
 108   2              {
 109   3                  con[0] = 10;
 110   3                  con[1] = 12 ;
 111   3                  flag = 1;
 112   3              }
 113   2              break;
 114   2          
 115   2          case 1:
 116   2              hour = (hour + 1) %24 ;
C51 COMPILER V9.59.0.0   PRO                                                               06/13/2024 15:51:14 PAGE 3   

 117   2              
 118   2              break;
 119   2      
 120   2          case 2:
 121   2              min = (min + 1) % 60 ;
 122   2              
 123   2              break;
 124   2      
 125   2          case 3:
 126   2              second = (second +1 ) % 60;
 127   2              
 128   2              break;
 129   2          
 130   2          case 4:
 131   2              if(flag)
 132   2              {
 133   3                  con[0] = 13;
 134   3                  con[1] = 13;
 135   3                  flag = 0;
 136   3              }
 137   2              break;
 138   2          
 139   2          case 5:
 140   2              hour = (hour + 23) %24 ;
 141   2              
 142   2              break;
 143   2          
 144   2          case 6:
 145   2              min = (min + 59) % 60 ;
 146   2              
 147   2              break;
 148   2      
 149   2          case 7:
 150   2              second = (second + 59 ) % 60;
 151   2              
 152   2              break;
 153   2          }
 154   1        change();
 155   1          DigDisplay();
 156   1        KeyValue = 8;
 157   1      }
 158          
 159          
 160          
 161          void Timer1Init()
 162          {
 163   1        TMOD|=0X10;//ÈÄâÊã©‰∏∫ÂÆöÊó∂Âô®1Ê®°ÂºèÔºåÂ∑•‰ΩúÊñπÂºè1Ôºå‰ªÖÁî®TR1ÊâìÂºÄÂêØÂä®„ÄÇ
 164   1      
 165   1        TH1=0XFC; //ÁªôÂÆöÊó∂Âô®ËµãÂàùÂÄºÔºåÂÆöÊó∂1ms
 166   1        TL1=0X18; 
 167   1        ET1=1;//ÊâìÂºÄÂÆöÊó∂Âô®1‰∏≠Êñ≠ÂÖÅËÆ∏
 168   1        EA=1;//ÊâìÂºÄÊÄª‰∏≠Êñ≠
 169   1        TR1=1;//ÊâìÂºÄÂÆöÊó∂Âô®     
 170   1      }
 171          
 172          void clock()
 173          {
 174   1        second++;
 175   1        if(second == 60)
 176   1        {
 177   2          second = 0;
 178   2          min ++ ;
C51 COMPILER V9.59.0.0   PRO                                                               06/13/2024 15:51:14 PAGE 4   

 179   2        }
 180   1        if(min == 60)
 181   1        {
 182   2          min =0 ;
 183   2          hour ++ ;
 184   2        }
 185   1        if(hour == 24)
 186   1        {
 187   2          hour =0 ;
 188   2        }
 189   1      }
 190          
 191          void main()
 192          { 
 193   1        Timer1Init();
 194   1        while(1)
 195   1          {
 196   2              KeyDown();
 197   2              show();
 198   2          }
 199   1      }
 200          
 201          void Timer1() interrupt 3
 202          {
 203   1        static u16 i;
 204   1        TH1=0XFC; //ÁªôÂÆöÊó∂Âô®ËµãÂàùÂÄºÔºåÂÆöÊó∂1ms
 205   1        TL1=0X18;
 206   1        i++;
 207   1        if(i==1000)
 208   1        {
 209   2          clock();
 210   2          change();
 211   2          DigDisplay();
 212   2          i = 0;
 213   2        } 
 214   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    733    ----
   CONSTANT SIZE    =     19    ----
   XDATA SIZE       =     16       1
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
